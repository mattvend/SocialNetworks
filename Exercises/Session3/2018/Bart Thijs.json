{"paragraphs":[{"text":"sc\nimport org.apache.log4j.{Level, Logger}\nimport org.apache.spark.graphx._\nimport org.apache.spark.storage.StorageLevel\nimport org.apache.spark.{SparkConf, SparkContext}\nimport java.io.{File, PrintWriter}\n\nimport scala.util.Random\n\nval storageLevel = StorageLevel.MEMORY_AND_DISK_SER\n\nval awspath = \"s3n://alssn-bucket/\"\n","dateUpdated":"2018-03-22T20:17:47+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: org.apache.spark.SparkContext = org.apache.spark.SparkContext@4ffdf4c7\nimport org.apache.log4j.{Level, Logger}\nimport org.apache.spark.graphx._\nimport org.apache.spark.storage.StorageLevel\nimport org.apache.spark.{SparkConf, SparkContext}\nimport java.io.{File, PrintWriter}\nimport scala.util.Random\nstorageLevel: org.apache.spark.storage.StorageLevel = StorageLevel(disk, memory, 1 replicas)\nawspath: String = s3n://alssn-bucket/\n"}]},"apps":[],"jobName":"paragraph_1521749853367_-938860264","id":"20170330-091844_86076181","dateCreated":"2018-03-22T20:17:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:177","user":"anonymous","dateFinished":"2018-03-22T20:18:20+0000","dateStarted":"2018-03-22T20:17:47+0000"},{"text":"val edges = sc.textFile(awspath+\"CA-HepPh.txt\",200)\n//https://snap.stanford.edu/data/ca-HepPh.html\nprintln(edges.partitions.size)\nedges.count","dateUpdated":"2018-03-22T20:59:12+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"edges: org.apache.spark.rdd.RDD[String] = s3n://alssn-bucket/CA-HepPh.txt MapPartitionsRDD[3] at textFile at <console>:37\n200\nres6: Long = 237014\n"}]},"apps":[],"jobName":"paragraph_1521749853379_-955789216","id":"20170330-091854_621657111","dateCreated":"2018-03-22T20:17:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:178","user":"anonymous","dateFinished":"2018-03-22T20:23:07+0000","dateStarted":"2018-03-22T20:22:51+0000"},{"text":"edges.take(50).foreach(println)\n\n","dateUpdated":"2018-03-22T20:23:20+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"# Directed graph (each unordered pair of nodes is saved once): CA-HepPh.txt \n# Collaboration network of Arxiv High Energy Physics category (there is an edge if authors coauthored at least one paper)\n# Nodes: 12008 Edges: 237010\n# FromNodeId\tToNodeId\n17010\t1943\n17010\t2489\n17010\t3426\n17010\t4049\n17010\t16961\n17010\t17897\n17010\t26904\n17010\t27801\n17010\t32403\n17010\t35262\n17010\t40848\n17010\t44114\n17010\t45648\n17010\t45654\n17010\t47702\n17010\t49335\n17010\t55416\n17010\t56358\n17010\t64003\n17010\t64714\n17010\t66411\n17010\t71844\n17010\t72504\n17010\t79185\n17010\t84491\n44114\t5874\n44114\t14789\n44114\t17010\n44114\t32403\n44114\t33245\n44114\t34338\n44114\t35262\n44114\t35425\n44114\t45648\n44114\t45654\n44114\t45957\n44114\t47702\n44114\t50498\n44114\t64714\n44114\t64959\n44114\t71391\n44114\t73805\n32403\t9497\n32403\t17010\n32403\t35425\n32403\t44114\n"}]},"apps":[],"jobName":"paragraph_1521749853379_-955789216","id":"20170330-092038_1229366296","dateCreated":"2018-03-22T20:17:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:179","user":"anonymous","dateFinished":"2018-03-22T20:23:23+0000","dateStarted":"2018-03-22T20:23:20+0000"},{"text":"val edges = sc.textFile(awspath+\"CA-HepPh.txt\",200).filter{\n    case(line:String)=>\n    !line.startsWith(\"#\")\n}.map{\n    case(line:String)=>\n    val lineArray= line.split(\"\\t\").filter(_.length()>0)\n    Edge(lineArray(0).toLong,lineArray(1).toLong,0L)\n}.cache()\nprintln(edges.count)","dateUpdated":"2018-03-22T21:09:07+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":6,"editorMode":"ace/mode/scala","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"edges: org.apache.spark.rdd.RDD[org.apache.spark.graphx.Edge[Long]] = MapPartitionsRDD[564] at map at <console>:46\n237010\n"}]},"apps":[],"jobName":"paragraph_1521749853380_-957712960","id":"20170330-103503_1520584940","dateCreated":"2018-03-22T20:17:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:180","user":"anonymous","dateFinished":"2018-03-22T21:04:20+0000","dateStarted":"2018-03-22T21:04:17+0000"},{"text":"val graph = Graph.fromEdges(edges,1L).cache()\ngraph.vertices.count","dateUpdated":"2018-03-22T21:01:37+0000","config":{"colWidth":6,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"graph: org.apache.spark.graphx.Graph[Long,Long] = org.apache.spark.graphx.impl.GraphImpl@7de27242\nres10: Long = 12008\n"}]},"apps":[],"jobName":"paragraph_1521749853380_-957712960","id":"20170330-103720_725772910","dateCreated":"2018-03-22T20:17:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:181","user":"anonymous","dateFinished":"2018-03-22T20:24:13+0000","dateStarted":"2018-03-22T20:24:08+0000"},{"text":"val dg = graph.degrees\n//degree.sortByKey().take(10).foreach(println)\nval dd = dg.map{case(id,d)=>d->1}.reduceByKey(_+_)\ndd.sortByKey().take(10).foreach(println)","dateUpdated":"2018-03-22T20:24:17+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dg: org.apache.spark.graphx.VertexRDD[Int] = VertexRDDImpl[21] at RDD at VertexRDD.scala:57\ndd: org.apache.spark.rdd.RDD[(Int, Int)] = ShuffledRDD[23] at reduceByKey at <console>:44\n(2,1494)\n(4,1801)\n(6,1488)\n(8,925)\n(10,648)\n(12,576)\n(14,416)\n(16,388)\n(18,283)\n(20,231)\n"}]},"apps":[],"jobName":"paragraph_1521749853382_-956943462","id":"20170330-104013_1575046385","dateCreated":"2018-03-22T20:17:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:182","user":"anonymous","dateFinished":"2018-03-22T20:24:22+0000","dateStarted":"2018-03-22T20:24:17+0000"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521750284988_-712225670","id":"20180322-202444_361781358","dateCreated":"2018-03-22T20:24:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1617","text":"println(\"%table\\ndegree\\tcount\\n\")\ndd.collect.foreach{case(id:Int,d:Int)=>println(id+\"\\t\"+d)}","dateUpdated":"2018-03-22T21:02:32+0000","dateFinished":"2018-03-22T20:24:53+0000","dateStarted":"2018-03-22T20:24:51+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"degree\tcount\n800\t1\n600\t1\n200\t5\n602\t1\n202\t7\n2\t1494\n404\t1\n4\t1801\n204\t4\n606\t4\n206\t8\n6\t1488\n806\t1\n408\t1\n208\t4\n8\t925\n610\t2\n210\t5\n10\t648\n212\t3\n12\t576\n612\t2\n14\t416\n214\t4\n16\t388\n216\t5\n616\t6\n18\t283\n218\t4\n618\t1\n818\t1\n420\t1\n220\t3\n620\t2\n20\t231\n22\t215\n222\t4\n422\t1\n224\t3\n424\t1\n24\t158\n624\t3\n626\t1\n226\t2\n26\t184\n28\t136\n428\t1\n228\t2\n628\t1\n230\t1\n30\t121\n830\t1\n232\t2\n632\t1\n32\t84\n34\t97\n634\t2\n234\t5\n36\t98\n236\t5\n238\t1\n38\t105\n240\t2\n40\t118\n42\t84\n642\t4\n242\t3\n844\t1\n44\t70\n244\t5\n644\t1\n46\t85\n846\t2\n848\t1\n48\t74\n248\t4\n650\t2\n850\t2\n50\t94\n250\t1\n52\t65\n252\t4\n652\t1\n254\t2\n54\t48\n654\t4\n56\t99\n456\t1\n256\t1\n656\t3\n258\t2\n58\t68\n260\t1\n60\t52\n660\t1\n262\t3\n62\t118\n662\t1\n64\t30\n664\t1\n264\t1\n66\t32\n666\t1\n668\t1\n268\t2\n68\t24\n70\t24\n670\t1\n672\t1\n272\t3\n72\t16\n74\t19\n274\t3\n76\t58\n676\t1\n276\t2\n476\t44\n278\t2\n478\t6\n78\t26\n280\t1\n80\t19\n480\t3\n880\t2\n482\t2\n82\t35\n84\t37\n484\t3\n684\t2\n486\t2\n286\t3\n686\t2\n886\t1\n86\t20\n488\t4\n888\t1\n88\t26\n490\t1\n90\t36\n690\t1\n290\t2\n692\t3\n292\t2\n92\t58\n492\t5\n694\t1\n294\t1\n494\t6\n94\t14\n296\t1\n96\t6\n696\t1\n496\t1\n698\t1\n298\t7\n98\t25\n498\t4\n100\t12\n300\t1\n700\t1\n500\t2\n502\t2\n302\t2\n102\t25\n704\t1\n504\t2\n104\t39\n304\t1\n106\t13\n506\t2\n708\t1\n508\t4\n108\t22\n110\t5\n710\t1\n512\t3\n112\t10\n514\t2\n114\t13\n116\t28\n316\t1\n516\t1\n518\t1\n118\t9\n718\t1\n120\t6\n320\t2\n520\t2\n122\t17\n322\t3\n522\t1\n324\t1\n124\t11\n526\t2\n326\t1\n126\t12\n128\t7\n528\t2\n728\t1\n328\t3\n130\t34\n530\t1\n730\t1\n532\t2\n132\t15\n134\t6\n534\t1\n734\t1\n334\t1\n336\t1\n136\t8\n338\t2\n138\t25\n538\t2\n540\t1\n340\t2\n140\t4\n742\t1\n142\t4\n542\t1\n744\t2\n544\t1\n344\t2\n144\t6\n346\t2\n146\t8\n546\t1\n548\t1\n748\t2\n148\t9\n150\t5\n750\t1\n550\t1\n152\t7\n154\t42\n556\t1\n156\t4\n356\t3\n158\t6\n358\t1\n558\t1\n160\t7\n760\t1\n762\t1\n362\t2\n162\t5\n564\t5\n164\t3\n964\t1\n566\t1\n366\t1\n166\t5\n168\t7\n370\t2\n170\t7\n172\t5\n972\t1\n372\t2\n574\t3\n174\t5\n376\t1\n176\t3\n578\t1\n178\t33\n180\t49\n380\t1\n582\t2\n182\t9\n982\t1\n184\t29\n584\t1\n384\t1\n386\t1\n186\t10\n388\t1\n188\t4\n788\t1\n588\t2\n190\t8\n590\t1\n592\t3\n192\t9\n194\t8\n594\t5\n596\t3\n196\t29\n598\t2\n198\t5\n"}]}},{"text":"val cc = graph.connectedComponents().vertices\ncc.take(10).foreach(println)","dateUpdated":"2018-03-22T20:26:20+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cc: org.apache.spark.graphx.VertexRDD[org.apache.spark.graphx.VertexId] = VertexRDDImpl[185] at RDD at VertexRDD.scala:57\n(32600,1)\n(73600,1)\n(17200,1)\n(77600,1)\n(2400,1)\n(11600,1)\n(10400,10400)\n(30600,1)\n(83000,1)\n(77200,1)\n"}]},"apps":[],"jobName":"paragraph_1521749853383_-957328211","id":"20170330-121344_1859317467","dateCreated":"2018-03-22T20:17:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:184","user":"anonymous","dateFinished":"2018-03-22T20:26:57+0000","dateStarted":"2018-03-22T20:26:20+0000"},{"text":"val cc_count = cc.map{case(id,cc)=>cc->1}.reduceByKey(_+_).sortByKey()\nprintln(cc_count.count)\ncc_count.take(20).foreach(println)\n","dateUpdated":"2018-03-22T20:27:27+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cc_count: org.apache.spark.rdd.RDD[(org.apache.spark.graphx.VertexId, Int)] = ShuffledRDD[205] at sortByKey at <console>:43\n278\n(1,11204)\n(69,2)\n(182,8)\n(230,4)\n(351,2)\n(417,2)\n(427,2)\n(623,8)\n(692,3)\n(712,6)\n(883,2)\n(884,4)\n(943,2)\n(997,4)\n(1121,2)\n(1296,2)\n(1411,3)\n(1427,2)\n(1522,5)\n(1542,6)\n"}]},"apps":[],"jobName":"paragraph_1521749853383_-957328211","id":"20170330-121611_48184668","dateCreated":"2018-03-22T20:17:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:185","user":"anonymous","dateFinished":"2018-03-22T20:27:22+0000","dateStarted":"2018-03-22T20:27:17+0000"},{"text":"import org.apache.spark.graphx.lib._\nval sp = ShortestPaths.run(graph,List(1L))\n// see https://github.com/apache/spark/blob/master/graphx/src/main/scala/org/apache/spark/graphx/lib/ShortestPaths.scala\nsp.vertices.filter{case(id,m)=>m.size>0}.take(10).foreach(println)","dateUpdated":"2018-03-22T20:37:39+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false},"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.graphx.lib._\nsp: org.apache.spark.graphx.Graph[org.apache.spark.graphx.lib.ShortestPaths.SPMap,Long] = org.apache.spark.graphx.impl.GraphImpl@4e4f4ff6\n(32600,Map(1 -> 8))\n(73600,Map(1 -> 6))\n(17200,Map(1 -> 5))\n(77600,Map(1 -> 6))\n(2400,Map(1 -> 7))\n(11600,Map(1 -> 6))\n(30600,Map(1 -> 5))\n(83000,Map(1 -> 6))\n(77200,Map(1 -> 5))\n(18200,Map(1 -> 7))\n"}]},"apps":[],"jobName":"paragraph_1521749853383_-957328211","id":"20170330-121846_1976748094","dateCreated":"2018-03-22T20:17:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:186","user":"anonymous","dateFinished":"2018-03-22T20:33:50+0000","dateStarted":"2018-03-22T20:33:23+0000"},{"text":"//val lp = LabelPropagation.run(graph,5).cache()\n//lp.vertices.take(10).foreach(println)\nlp.vertices.filter{case(id,m)=>m==19437}.take(10).foreach(println)\nlp.vertices.filter{case(id,m)=>id==19437}.take(10).foreach(println)\ncc.filter{case(id,m)=>id==19437}.collect.foreach(println)\n","dateUpdated":"2018-03-22T20:17:33+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(32600,19437)\n(29805,19437)\n(19437,29805)\n(19437,1)\n"}]},"apps":[],"jobName":"paragraph_1521749853384_-959251956","id":"20170330-122550_1432425643","dateCreated":"2018-03-22T20:17:33+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:187"},{"dateUpdated":"2018-03-22T20:17:33+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1521749853384_-959251956","id":"20170330-124442_325978291","dateCreated":"2018-03-22T20:17:33+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:188"}],"name":"Bart Thijs","id":"2D8JQDPCA","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}